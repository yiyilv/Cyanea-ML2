# Cyanea-ML2

Machine Learning for User Behavior Recognition

## Project Overview

This project uses machine learning techniques to train a model that recognizes user behavior types based on gesture records generated by the App:

1. Watching Videos (browsing_mode=1)
2. Browsing Infinite Feed, excluding videos (browsing_mode=2)
3. Other Activities (browsing_mode=3)

## Project Structure

```
Cyanea-ML2/
├── models/                  # Model storage directory
├── realdata/                # Real dataset directory
├── results/                 # Prediction results directory
├── src/                     # Source code directory
│   ├── __init__.py
│   ├── data_processor.py    # Data processing class
│   ├── model_trainer.py     # Model training class
│   ├── predictor.py         # Prediction class
│   └── main.py              # Main program entry
├── train_deep_model.py      # Deep learning model training script
├── prediction_with_deep.py  # Deep learning model prediction script
├── visualize_feature_importance.py # Feature importance visualization
├── requirements.txt         # Dependency list
└── README.md                # Project documentation
```

## Environment Setup

This project supports two environments:

1. Basic environment (traditional machine learning models)
2. TensorFlow environment (deep learning models)

### Basic Environment Setup

```bash
# Create basic virtual environment
python -m venv venv

# Activate environment
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows

# Install dependencies
pip install -r requirements.txt
```

### TensorFlow Environment Setup

```bash
# Create TensorFlow virtual environment
python -m venv venv_tf

# Activate environment
source venv_tf/bin/activate  # Linux/Mac
venv_tf\Scripts\activate     # Windows

# Install dependencies
pip install -r requirements.txt
```

## Usage

### 1. Training Models

#### Training Traditional Machine Learning Models

```bash
# Activate basic environment
source venv/bin/activate

# Train a single model
python src/main.py train --data_dir realdata --output_dir models --no_ensemble
# Train ensemble model
python src/main.py train --data_dir realdata --output_dir models
```

#### Training Deep Learning Models

```bash
# Activate TensorFlow environment
source venv_tf/bin/activate

# Train deep learning model
python train_deep_model.py --data_dir realdata --output_dir models
# Or
python src/main.py train --data_dir realdata --output_dir models --use_sequence
```

### 2. Prediction

#### Predicting with Traditional Machine Learning Models

```bash
# Activate basic environment
source venv/bin/activate

# Predict using Random Forest model
python src/main.py predict --model_dir models --model_type random_forest --files realdata/22.csv realdata/24.csv

# Predict using Gradient Boosting model
python src/main.py predict --model_dir models --model_type gradient_boosting --files realdata/22.csv realdata/24.csv

# Predict using SVM model
python src/main.py predict --model_dir models --model_type svm --files realdata/22.csv realdata/24.csv

# Predict using Ensemble model
python src/main.py predict --model_dir models --model_type ensemble --files realdata/22.csv realdata/24.csv
```

#### Predicting with Deep Learning Models

```bash
# Activate TensorFlow environment
source venv_tf/bin/activate

# Method 1
python prediction_with_deep.py --files realdata/22.csv realdata/24.csv --output_dir results

# Method 2
python src/main.py predict --model_dir models --model_type sequence --files realdata/22.csv realdata/24.csv --use_time_series
```

### 3. Visualizing Feature Importance

```bash
# Activate basic environment
source venv/bin/activate

# Visualize Random Forest model feature importance
python visualize_feature_importance.py --model_path models/random_forest_model.pkl --output_dir models
```

## Model Performance Comparison

| Model Type | Accuracy | Advantages | Disadvantages |
|---------|-------|------|------|
| Random Forest | 93-100% | High stability, highest prediction accuracy | Relatively weaker interpretability |
| Gradient Boosting | 70-80% | Good at capturing feature relationships | Relatively lower accuracy |
| SVM | 90-95% | Strong ability to handle non-linear data | Higher computational complexity |
| Ensemble Model | 90-95% | Combines advantages of multiple models | High complexity, potential overfitting |
| Deep Learning | 57-80% | Can process temporal relationships | Data-dependent, complex training |

## Bug Fixes and Improvements

1. Fixed the 'dict' object has no attribute 'predict' error when predicting with ensemble models
2. Fixed sequence model path errors, now supporting multiple extensions (.keras, .h5, etc.)
3. Improved prediction logic with a downgrade mechanism, attempting to use backup models when primary model prediction fails
4. Enhanced error handling, improving code robustness
5. Added file path validation to ensure files exist when predicting

## Developer Information

For more information or to contribute, please contact the project maintainer. 